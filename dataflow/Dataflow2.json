{
	"name": "Dataflow2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ADLS_meridata_JSON",
						"type": "DatasetReference"
					},
					"name": "meridata"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "flattenJsonToTable"
				},
				{
					"name": "select1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          type as string,",
				"          dataUpdatedTime as string,",
				"          features as (siteNumber as integer, type as string, geometry as (type as string, coordinates as double[]), properties as (siteNumber as integer, siteName as string, siteType as string, lastUpdate as string, seaState as string, trend as string, windWaveDir as integer, confidence as string, heelAngle as double, lightStatus as string, temperature as integer))[]",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     documentForm: 'singleDocument') ~> meridata",
				"select1 foldDown(unroll(, features),",
				"     mapColumn(",
				"          coordinates_geom = features.geometry.coordinates,",
				"          siteNumber = features.siteNumber,",
				"          siteName = features.properties.siteName,",
				"          siteType = features.properties.siteType,",
				"          lastUpdate = features.properties.lastUpdate,",
				"          seaState = features.properties.seaState,",
				"          trend = features.properties.trend,",
				"          windWaveDir = features.properties.windWaveDir,",
				"          confidence = features.properties.confidence,",
				"          heelAngle = features.properties.heelAngle,",
				"          lightStatus = features.properties.lightStatus,",
				"          temperature = features.properties.temperature,",
				"          latitude = {features.geometry.coordinates[0]},",
				"          coordinates = features.geometry.coordinates",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> flattenJsonToTable",
				"meridata select(mapColumn(",
				"          features",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1"
			]
		}
	}
}